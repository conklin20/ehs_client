<?xml version="1.0" encoding="utf-8" ?>
<!-- XSD manual extracted from package NLog.Schema: https://www.nuget.org/packages/NLog.Schema-->
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd" 
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.nlog-project.org/schemas/NLog.xsd NLog.xsd"
      autoReload="true"
      internalLogLevel="Info" 
      internalLogFile="C:\Users\caryc\Projects\Vista Outdoor\EHS\temp\nlog-internal.log" >

  <!-- the targets to write to -->
  <targets>
    <!-- write to SQL database-->
    <target xsi:type="Database" 
            name="sqlLog" 
            connectionString="${gdc:item=nLogConnectionString}" 
            commandText="Insert into app.AppLog ( AppId, Level, Logger, UserName, MachineName, LoggedOn, Thread, Message, CallSite, Exception, StackTrace)
                          values (1, @Level, @Logger, @UserName, @machinename, @LoggedOn , @Thread , @Message, @CallSite, @Exception, @StackTrace   );">
      <parameter name="@AppId" layout="1" />
      <parameter name="@Level" layout="${level}" />
      <parameter name="@Logger" layout="${logger}" />
      <parameter name="@Username" layout="${identity:authType=false:isAuthenticated=false}" />      
      <parameter name="@Machinename" layout="${logger}" />
      <parameter name="@Loggedon" layout="${date:universalTime=true}" />
      <parameter name="@Thread" layout="${threadid}" />
      <parameter name="@Message" layout="${message}" />
      <parameter name="@CallSite" layout="${callsite}" />      
      <parameter name="@Exception" layout="${exception:format=tostring}" />
      <parameter name="@StackTrace" layout="${stacktrace}" />
    </target>
          

    <!--<target name="database"
            xsi:type="Database"
            connectionString="Data Source=.\;Initial Catalog=EHS_Dev;Integrated Security=true"            
            commandText ="Insert into app.AppLog ( AppId, Level, CallSite, Type, Message, StackTrace, InnerException, AdditionalInfo)
                          values (1, @level, @callsite, @type, @message, @stackTrace, @innerException, @additionalInfo)">
      
      -->
    <!--<parameter name="@appid" layout="${appid}"/>-->
    <!--
      <parameter name="@level" layout="${level}"/>
      <parameter name="@callsite" layout="${callsite}"/>
      <parameter name="@type" layout="${exception}"/>
      <parameter name="@message" layout="${message}"/>
      <parameter name="@stackTrace" layout="${exception}"/>
      <parameter name="@innerException" layout="${exception}"/>
      <parameter name="@additionalInfo" layout="${message}"/>
    </target>-->
    
    <!-- write logs to file -->
    <target xsi:type="File" 
            name="fileLog" 
            layout="${date}|${level:uppercase=true}|${message} ${exception}|${logger}|${all-event-properties}"
            fileName="${basedir}/logs/current.txt" 
            archiveFileName="${basedir}/logs/archiveLog.{#}.log"
            maxArchiveFiles="14" 
            archiveEvery="Day"/>
    
    <target xsi:type="Console" name="consoleLog"
            layout="${date}|${level:uppercase=true}|${message} ${exception}|${logger}|${all-event-properties}" />
  </targets>

  <!-- rules to map from logger name to target -->
  <rules>
    <logger name="*" minlevel="Trace" writeTo="sqlLog,fileLog,consoleLog" />
  </rules>
</nlog>